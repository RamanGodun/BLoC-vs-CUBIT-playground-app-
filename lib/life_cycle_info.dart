/*
==========================================================
üìå 1Ô∏è‚É£ –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª —Ç–∞ —Ä–æ–±–æ—Ç–∞ Cubit (–ì–ª–∏–±–æ–∫–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è)
==========================================================

–Ø–∫ –ø—Ä–∞—Ü—é—î Cubit?
---------------------------------
Cubit ‚Äì —Ü–µ —Å–ø—Ä–æ—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è BLoC, —è–∫–∞ –º–∞—î **–ø—Ä—è–º–∏–π –º–µ—Ç–æ–¥ emit()** –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É.  
–ô–æ–≥–æ –∂–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

1Ô∏è‚É£ **–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è**
   ‚Ä¢ `CubitProvider` –∞–±–æ `Cubit()` —Å—Ç–≤–æ—Ä—é—î –µ–∫–∑–µ–º–ø–ª—è—Ä Cubit.
   ‚Ä¢ –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è **–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**, –≤ —è–∫–æ–º—É –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è `initialState`.

2Ô∏è‚É£ **–í–∑–∞—î–º–æ–¥—ñ—è –∑ UI**
   ‚Ä¢ UI –≤–∏–∫–ª–∏–∫–∞—î –º–µ—Ç–æ–¥ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `increment()`).
   ‚Ä¢ –ú–µ—Ç–æ–¥ –æ–±—á–∏—Å–ª—é—î **–Ω–æ–≤–∏–π —Å—Ç–∞–Ω** —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—î `emit(newState)`.  

3Ô∏è‚É£ **–í–∏–∫–æ–Ω–∞–Ω–Ω—è emit()**
   ‚Ä¢ Cubit **–≤–∏–∫–ª–∏–∫–∞—î `onChange(Change<T>)`** –ø–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º —Å—Ç–∞–Ω—É.
   ‚Ä¢ `Change<T>` –º—ñ—Å—Ç–∏—Ç—å **–ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω (`currentState`) —Ç–∞ –Ω–æ–≤–∏–π (`nextState`)**.
   ‚Ä¢ –Ø–∫—â–æ `currentState == nextState`, —Ç–æ `emit()` –Ω–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è.

4Ô∏è‚É£ **–û–Ω–æ–≤–ª–µ–Ω–Ω—è UI**
   ‚Ä¢ `BlocBuilder` –∞–±–æ `BlocListener` –æ—Ç—Ä–∏–º—É—î –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞–Ω —Ç–∞ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä—é—î UI.

5Ô∏è‚É£ **–ó–∞–∫—Ä–∏—Ç—Ç—è (close())**
   ‚Ä¢ –ö–æ–ª–∏ Cubit –±—ñ–ª—å—à–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `close()`.
   ‚Ä¢ –ü–æ—Ç—ñ–∫ `state.stream` –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, –ø–∞–º'—è—Ç—å –æ—á–∏—â–∞—î—Ç—å—Å—è.

üìù **–ü—Ä–∏–∫–ª–∞–¥**:
-----------------------------------------------------------
class CounterCubit extends Cubit<int> {
  CounterCubit() : super(0);

  void increment() {
    emit(state + 1);
  }

  @override
  void onChange(Change<int> change) {
    print('onChange: $change');
    super.onChange(change);
  }

  @override
  Future<void> close() {
    print('Cubit –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è...');
    return super.close();
  }
}
-----------------------------------------------------------

==========================================================
**********************************************************
==========================================================

üìå 2Ô∏è‚É£ –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª —Ç–∞ —Ä–æ–±–æ—Ç–∞ BLoC (–ì–ª–∏–±–æ–∫–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è)
==========================================================

BLoC ‚Äì —Ü–µ **—Ä–µ–∞–∫—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥**, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–ø–æ–¥—ñ—ó (Event) —Ç–∞ –ø–æ—Ç–æ–∫–∏ (Stream)**.

–Ø–∫ –ø—Ä–∞—Ü—é—î BLoC?
---------------------------------
1Ô∏è‚É£ **–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è**
   ‚Ä¢ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `BlocProvider` –∞–±–æ `Bloc()`.
   ‚Ä¢ –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `super(initialState)`.

2Ô∏è‚É£ **–î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–¥—ñ—ó (add(event))**
   ‚Ä¢ UI –≤–∏–∫–ª–∏–∫–∞—î `bloc.add(MyEvent())`.
   ‚Ä¢ –°–ø—Ä–∞—Ü—å–æ–≤—É—î `onEvent()`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ª–æ–≥—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é.

3Ô∏è‚É£ **Event Transformer (–û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π —É –ø–æ—Ç–æ—Ü—ñ)**
   ‚Ä¢ `BLoC` –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ** –æ–±—Ä–æ–±–ª—è—î –ø–æ–¥—ñ—ó.
   ‚Ä¢ –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **RxDart** (`debounceTime`, `switchMap`) –¥–ª—è **–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó**.

4Ô∏è‚É£ **–û–±—Ä–æ–±–∫–∞ Event Handler (`on<T>`)**
   ‚Ä¢ –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π `on<T>` –≤–∏–∫–æ–Ω—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—î `emit(newState)`.
   ‚Ä¢ **BLoC –º–æ–∂–µ –µ–º—ñ—Ç—É–≤–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ —Å—Ç–∞–Ω—ñ–≤ –ø–æ—Å–ø—ñ–ª—å**.

5Ô∏è‚É£ **–ó–º—ñ–Ω–∞ —Å—Ç–∞–Ω—É (`emit(newState)`)**
   ‚Ä¢ –°–ø—Ä–∞—Ü—å–æ–≤—É—î `onTransition()`, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å `currentState ‚Üí nextState`.

6Ô∏è‚É£ **–ó–∞–∫—Ä–∏—Ç—Ç—è (close())**
   ‚Ä¢ –ü–æ—Ç—ñ–∫ `state.stream` –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, –ø—ñ–¥–ø–∏—Å–∫–∏ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è.
   ‚Ä¢ –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `onClose()` –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ.

üìù **–ü—Ä–∏–∫–ª–∞–¥**:
-----------------------------------------------------------
class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0) {
    on<IncrementEvent>((event, emit) {
      emit(state + 1);
    });
  }

  @override
  void onEvent(CounterEvent event) {
    print('onEvent: $event');
    super.onEvent(event);
  }

  @override
  void onTransition(Transition<CounterEvent, int> transition) {
    print('onTransition: $transition');
    super.onTransition(transition);
  }

  @override
  Future<void> close() {
    print('Bloc –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è...');
    return super.close();
  }
}
-----------------------------------------------------------


==========================================================
**********************************************************
==========================================================


üìå –ü–∞—Ç–µ—Ä–Ω–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó BLoC
==========================================================

BLoC, —â–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—à–æ–≥–æ BLoC (Stream Subscription)

–Ø–∫—â–æ `BLoC A` –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ `BLoC B`, —î 2 –ø—ñ–¥—Ö–æ–¥–∏:
   ‚Ä¢ –õ–∏—à–µ **—Å–∞–π—Ç-–µ—Ñ–µ–∫—Ç–∏ (`BlocListener`)**.
   ‚Ä¢ –ü–æ–≤–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —á–µ—Ä–µ–∑ **StreamSubscription**.

‚úÖ **1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è BlocListener –¥–ª—è Side Effects**
-----------------------------------------------------------
BlocListener<ColorBloc, ColorState>(
  listenWhen: (previous, current) => previous.color != current.color,
  listener: (context, state) {
    if (state.color == Colors.red) {
      ScaffoldMessenger.of(context).showSnackBar(SnackBar(
        content: Text('Color changed to red!'),
      ));
    }
  },
  child: MyWidget(),
);
-----------------------------------------------------------

‚úÖ **2. –ü–æ–≤–Ω–∞ –ø—ñ–¥–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ StreamSubscription**
-----------------------------------------------------------
class CounterBloc extends Bloc<CounterEvent, int> {
  final ColorBloc colorBloc;
  late final StreamSubscription colorSubscription;

  CounterBloc(this.colorBloc) : super(0) {
    colorSubscription = colorBloc.stream.listen((colorState) {
      if (colorState.color == Colors.red) {
        add(IncrementEvent());
      }
    });

    on<IncrementEvent>((event, emit) {
      emit(state + 1);
    });
  }

  @override
  Future<void> close() {
    colorSubscription.cancel();
    return super.close();
  }
}
-----------------------------------------------------------


==========================================================
**********************************************************
==========================================================


üìå –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ç–∞ –Ω–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏
==========================================================

‚úÖ **1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ buildWhen —É BlocBuilder**
-----------------------------------------------------------
BlocBuilder<MyBloc, MyState>(
  buildWhen: (previous, current) => previous.counter != current.counter,
  builder: (context, state) {
    return Text('${state.counter}');
  },
);
-----------------------------------------------------------

‚úÖ **2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ debounceTime –¥–ª—è —á–∞—Å—Ç–∏—Ö –ø–æ–¥—ñ–π**
-----------------------------------------------------------
EventTransformer<E> debounceSequential<E>() {
  return (events, mapper) {
    return events.debounceTime(Duration(milliseconds: 300)).switchMap(mapper);
  };
}
-----------------------------------------------------------

‚úÖ **3. –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–µ—Ä–µ–¥ emit()**
-----------------------------------------------------------
void safeEmit(MyBloc bloc, MyState newState) {
  if (!bloc.isClosed) bloc.emit(newState);
}
-----------------------------------------------------------

==========================================================
üìå **–í–∏—Å–Ω–æ–≤–∫–∏**
==========================================================
‚Ä¢ **Cubit**: –ü—Ä–æ—Å—Ç–∏–π, –º–∞—î `emit()`, –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Events.
‚Ä¢ **BLoC**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **Event-driven** –ø—ñ–¥—Ö—ñ–¥, –ø—Ä–∞—Ü—é—î –∑ `Stream`.
‚Ä¢ **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è**:
  - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `buildWhen`.
  - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `debounceTime`.
  - –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ `isClosed` –ø–µ—Ä–µ–¥ `emit()`.
‚Ä¢ **–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –º—ñ–∂ BLoC**:
  - `BlocListener` –¥–ª—è **—Å–∞–π–¥-–µ—Ñ–µ–∫—Ç—ñ–≤**.
  - `StreamSubscription` –¥–ª—è **–ø–æ–≤–Ω–æ—ó –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ**.

==========================================================
**********************************************************
==========================================================


*/
